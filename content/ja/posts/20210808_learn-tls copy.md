---
title: "SSLについて学ぶ"
date: 2021-07-18T17:31:36+09:00
description:
draft: true
hideToc: false
enableToc: true
enableTocContent: true # 目次
tocPosition: inner
tags:
- tls
series:
-
categories:
-
---

## 背景

nginxでTLS1.3を有効化にして通信させたかった。`RSA`は今までも使ったことあるが、`ECDHE`とか使ったことなくてよくわからない。
このあたりのセキュリティに関する知識が乏しい。。。ので一度しっかり調べてみた。書かないとすぐ忘れてしまうのでそのまとめ。

## SSL/TLSについて

さっくりとSSL/TLSについておさらい。

### SSL通信とは

SSL(TLS)とは、クライアントとサーバ間でデータを暗号化し通信を行う仕組みのことで、OSI参照モデルではセッション層に位置するプロトコルのことを指す。
![tls 01](/images/posts/20210808/tls_01.png)

SSL通信を利用することで悪意あるユーザ（図上の攻撃者）から通信情報を盗聴された際、実際にやり取りされたデータは暗号化されているため解読することができず、データの盗聴を防ぐことができる。

### SSLとTLSの違いって何？

目的はSSLもTLSも変わらず、「インターネットを介したクライアントとサーバ間を安全に通信するためのプロトコル」というところは一緒。
その仕組みとしてSSLプロトコルが開発され、脆弱性が見つかるにつれバージョンアップされていった。

SSL3.0までバージョンアップされたところでgoogleのセキュリティチームより`POODLE`という名前の脆弱性が報告され、これによりSSL3.0を利用した通信が解読できることがわかった。SSL3.0をベースとして新たに開発されたのがTLSプロトコルとのこと。

IPAの[TLS 暗号設定ガイドライン(ver3.0.1 11ページ)](https://www.ipa.go.jp/security/ipg/documents/ipa-cryptrec-gl-3001-3.0.1.pdf)によるとTLS1.0はSSL3.1とも呼ばれるらしい。

個人的になんでTLSという名前にこのタイミングでしたのか気になった。
確実的なことは書いていなかったので半分推測だが、一般社団法人日本ネットワークインフォメーションセンターの[SSL/TLS 20年の歩みと動向](https://www.nic.ad.jp/ja/newsletter/No59/0800.html)によると、1996年（TLSプロトコルが発表されたのは1999年）に`SSLの標準化がネットスケープコミュニケーションズ社からIETF TLSワーキンググループに移管された`そうなので、恐らくそのタイミングでプロトコル名をTLSとするのが色々都合がよかったのだろうと推測している。。

発見された脆弱性の内容などは、以下のリンクが参考になった。

* [SSL/TLS 20年の歩みと動向](https://www.nic.ad.jp/ja/newsletter/No59/0800.html)
* [トレンドマイクロセキュリティログ(SSL 3.0 の脆弱性「POODLE」とは？)](https://blog.trendmicro.co.jp/archives/10112)

2020年3月時点では、`TLS1.2`, `TLS1.3`を利用することが安全上望ましいとされている。







#### Perfect Forward Secrecyとは

TLSによるセキュアな通信は、`セッション鍵`という鍵情報を利用しデータを暗号化して通信する。

`セッション鍵`は通常、セッションごとに更新される事になるため、セッション鍵の情報が漏洩したとしても、同一セッション以外の情報は保護される。

しかし、鍵の生成に利用している秘密鍵が漏洩した場合、過去のセッションで利用やり取りされたデータも漏洩する恐れがある。

それを防ぐため、都度乱数を利用して鍵を生成するようにしている。そうすることで、過去のセッションの情報を漏洩させないようにしている仕組み。



## 参考

* [SSL/TLS 暗号設定ガイドラインv3.01(2020年7月)](https://www.ipa.go.jp/security/ipg/documents/ipa-cryptrec-gl-3001-3.0.1.pdf)
* [SSL/TLS 20年の歩みと動向](https://www.nic.ad.jp/ja/newsletter/No59/0800.html)







